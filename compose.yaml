services:
    # nginx:
    #   restart: always
    #   image: nginx:latest
    #   ports:
    #     - "8080:80"
    #   volumes:
    #     - ./nginx.conf:/etc/nginx/nginx.conf
    #   develop:
    #     watch:
    #       - action: restart
    #         path: ./nginx.conf

    #   depends_on:
    #     - frontend
    #     - backend
    #   networks:
    #     - private

    app:
        build: ./app
        image: pinheiroreis/school-secretary-app:latest
        ports:
            - "3000:3000"
        environment:
            - NODE_ENV=development
        develop:
            watch:
                - action: sync
                  path: ./app
                  target: /app
                  ignore:
                      - node_modules/
                      - dist/

                - action: rebuild
                  path: package.json
        networks:
            - private

    api:
        build: ./api
        image: pinheiroreis/school-secretary-api:latest
        ports:
            - "8000:8000"
        develop:
            watch:
                - action: sync
                  path: ./api
                  target: /api

        networks:
            - private

networks:
    private:
        driver: bridge
